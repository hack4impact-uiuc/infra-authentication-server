---
name: Authentication Server
route: /
---


# Authentication Server

We want to build a open sourced authentication system with easy integration and well-thought out solutions for allowing users to securely handle signing up for an account, logging in, changing passwords, and promoting people to different levels of access. This will allow our teams to add this authentication system to their infrastructure at any point in time in a time.

To do this we want to build an independent server for authentcation that is autogenerated with a configuration file to meet the teams need. The API talks to this authentcation server before sending back information, check


The authentication server comes with end points all ready build for all authentictaion workflows. 


## Registration 

1. The Authentictaion Server recieves an email, password, and role. It responds with a 400 error if any of the arguments aren't there. 
2. Checks that there aren't any users with the same email. 
3. Checks that the user can sign up for that role by checking th configuration file. (eg the user can't sign up as an admin)
4. Creates a new user in the database. 
5. If the config file specifies email verification, it sends an email to te user to verify their account. 
6. It sends a valid jwt token, user id, and permission level to the API. 
7. The API sends the token to the client. The client stores the token in cookies and sends it in the header of every request. 

| Endpoint | /register [POST] |
| ------ | ----------- |
| Body   | email, hashed password, amd role |
| Response 200 | userid, role, and token |
| Response 400 | error message |

## Login
1. The Authentictaion Server recieves an email and password.  It responds with a 400 error if any of the arguments aren't there. 
2. Finds the user in the database using the email. If the user doesn't exits or te user is using google oauth, it returns a corresponding error message. 
3. It encrypts the password and compares it to the password stored in the database. 
4. It sends a valid jwt token, user id, and permission level to the API. 
5. The API sends the token to the client. The client stores the token in cookies and sends it in the header of every request. 

| Endpoint | /login [POST] |
| ------ | ----------- |
| Body   | email, hashed password |
| Response 200 | userid, role, and token |
| Response 400 | error message |


## Verify
1. The token is sent in the header of the request to the authentictaion server. 
2. The token is verified with the secret token (which is refresehd by the authentcation server every hour)
3. The response is either 200 if the token is valid, and 400 otherwise

| Endpoint | /verify [POST] |
| ------ | ----------- |
| Header   | token |
| Response 200 | success message |
| Response 400 | error message |


## Forgot Password

### Adding Security Question 

1. The Authentictaion Server recieves an token, question, and answer. It responds with a 400 error if any of the arguments aren't there. 
2. It decrypts the jwt token and ensures it is a valid user. Otherwise, it sends a corresponding error message. 

| Endpoint | /addSecurityQuestion [POST] |
| ------ | ----------- |
| Header   | token |
| Response 200 | userid, role, and token |
| Response 400 | error message |


### Getting the Security Question

| Endpoint | /getSecurityQuestion [POST] |
| ------ | ----------- |
| Header   | token |
| Response 200 | userid, role, and token |
| Response 400 | error message |

### ForgotPassword

| Endpoint | /forgotPassword [POST] |
| ------ | ----------- |
| Header   | token |
| Response 200 | userid, role, and token |
| Response 400 | error message |

### ChangePassword

| Endpoint | /changePassword [POST] |
| ------ | ----------- |
| Header   | token |
| Response 200 | userid, role, and token |
| Response 400 | error message |



## Google Authentication


## Changing Roles



# Features

1. Registering and Login that email's you to verify your account
2. Forgot Password Pages that use either a pin or security question, and then allows you to reset your password
3. Can define a config file that defines the different user levels, and allow certain users to promote others to a higher user levels
4. Can use google authentication


